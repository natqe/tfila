<?php
if (!in_array($request_page, $pages)) $request_page = $not_found;
if($request_page !== $sign_in && $request_page !== $sign_up){
    $fetch_preface = $pdo->query("SELECT title, body FROM prefaces WHERE page='$request_page'")->fetch();
}
if (!in_array($request_page, array_column($fetch_pages, 'name'))) {
    require_once "html/body/main/$request_page.html";
} else {
?>
<section>
    <article>
            <h2><?=$fetch_preface['title'] ?? ''?></h2>
            <p><?=$fetch_preface['body'] ?? ''?></p>
    </article>
<?php
    $fetch_articles = $pdo->query(
        "SELECT title, SUBSTRING(body, 1, 200) as sub_body FROM articles WHERE page='$request_page' ORDER BY created_at DESC"
    )->fetchAll();
    foreach ($fetch_articles as $article) {
?>
    <article id="<?='#'.str_replace(' ', '-', $article['title'])?>">
            <h2><?=$article['title']?></h2>
            <p><?=$article['sub_body'] . '...'?></p>
    </article>
<?php
    }
?>
</section>
<aside>
<?php
    foreach ($fetch_articles as $article) {
?>
    <a href=<?='#' . str_replace(' ', '-', $article['title'])?>><?=$article['title']?></a>
<?php
    }
}
?>
</aside>