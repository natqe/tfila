<?php
if($request_page !== $sign_in && $request_page !== $sign_up){
    $fetch_preface = $pdo->query("SELECT title, body FROM prefaces WHERE page='$request_page'")->fetch();
}
if (!in_array($request_page, $pages_from_db)) {
    require_once "html/body/main/$request_page.html";
} else {
    foreach ($fetch_pages as $page) if ($page['name'] === $request_page) $type = $page['type'];
?>
<section>
    <article>
            <h2><?=$fetch_preface['title'] ?? ''?></h2>
            <p><?=$fetch_preface['body'] ?? ''?></p>
    </article>
<?php
    $fetch_articles = $pdo->query(
        "SELECT id, title, SUBSTRING(body, 1, 200) as sub_body FROM articles WHERE page='$request_page' ORDER BY created_at DESC"
    )->fetchAll();
    foreach ($fetch_articles as $article) {
?>
    <article id=<?=str_replace(' ', '-', $article['title'])?>>
            <h2 data-id=<?=$article['id']?>><?=$article['title']?></h2>
            <p id=<?=$article['id']?>><?=mb_substr($article['sub_body'], 0, rand(150, strlen($article['sub_body'])-1))?>...</p>
    </article>
<?php
    }
?>
</section>
<aside>
<?php
    foreach ($fetch_articles as $article) {
?>
    <a href=#<?=str_replace(' ', '-', $article['title'])?> data-id=<?=$article['id']?>><?=$article['title']?></a>
<?php
    }
}
?>
</aside>